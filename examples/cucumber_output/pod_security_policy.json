[
    {
        "uri": "/probr/probes/kubernetes/probe_specifications/pod_security_policy.feature",
        "id": "maximise-security-through-pod-security-policies",
        "keyword": "Feature",
        "name": "Maximise security through Pod Security Policies",
        "description": "As a Cloud Security Auditor\nI want to ensure that a stringent set of Pod Security Policies are present\nSo that a policy of least privilege can be enforced in order to prevent malicious attacks on my organization",
        "line": 8,
        "comments": [
            {
                "value": "#@csp/openshift TODO: OpenShift uses SecurityContextConstraints so the implementation of the \"Given\" clauses will fail",
                "line": 6
            },
            {
                "value": "#Rule: Insert tags here. ... for some reason 'Rule:' doesn't work in latest godog ..",
                "line": 14
            },
            {
                "value": "#TODO: for 5.2.1 .. these are all 'creation', so 'deployment running' should be changed to 'deployment created'",
                "line": 15
            },
            {
                "value": "#TODO: question .. how specific should we be on the control terminology?  e.g. should we stick with",
                "line": 16
            },
            {
                "value": "# the below, or specific, like \"And 'isPrivileged' is set to \u003ctrue|false\u003e\"??",
                "line": 17
            },
            {
                "value": "#TODO: also ... for 5.2.5, we can test to prevent creation, but what about trying to execute a cmd which reqs root?",
                "line": 18
            },
            {
                "value": "# think we should do that, but is that a separate scenario or blend into this one?  for some this makes sense - mark with @detective?",
                "line": 19
            }
        ],
        "tags": [
            {
                "name": "@service/kubernetes",
                "line": 1
            },
            {
                "name": "@control/family/pod_security_policy",
                "line": 2
            },
            {
                "name": "@csp/azure",
                "line": 3
            },
            {
                "name": "@csp/aws",
                "line": 4
            },
            {
                "name": "@csp/gcp",
                "line": 5
            },
            {
                "name": "@standard/cis/5.2",
                "line": 7
            }
        ],
        "elements": [
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-privileged-access;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with privileged access",
                "description": "",
                "line": 33,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 21
                    },
                    {
                        "name": "@standard/cis/5.2.1",
                        "line": 21
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 33,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 51902
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment running with privileged access in an existing Kubernetes cluster",
                        "line": 33,
                        "match": {
                            "location": "pod_security_policy.go:146"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 166247543
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 33,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 53201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged access request is marked \"True\" for the Kubernetes deployment",
                        "line": 33,
                        "match": {
                            "location": "pod_security_policy.go:127"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 174315598
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with privileged access can't run\"",
                        "line": 33,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 110904
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 33,
                        "match": {
                            "location": "pod_security_policy.go:156"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 48501
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 33,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 28401
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-privileged-access;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with privileged access",
                "description": "",
                "line": 34,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 21
                    },
                    {
                        "name": "@standard/cis/5.2.1",
                        "line": 21
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 34,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2367474
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment running with privileged access in an existing Kubernetes cluster",
                        "line": 34,
                        "match": {
                            "location": "pod_security_policy.go:146"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 82003
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 34,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 52502
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged access request is marked \"False\" for the Kubernetes deployment",
                        "line": 34,
                        "match": {
                            "location": "pod_security_policy.go:127"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2489201106
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 34,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 82603
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 34,
                        "match": {
                            "location": "pod_security_policy.go:156"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 732911015
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 34,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 610145943
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-privileged-access;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with privileged access",
                "description": "",
                "line": 35,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 21
                    },
                    {
                        "name": "@standard/cis/5.2.1",
                        "line": 21
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 35,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 44101
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment running with privileged access in an existing Kubernetes cluster",
                        "line": 35,
                        "match": {
                            "location": "pod_security_policy.go:146"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 45302
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 35,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 28700
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged access request is marked \"Not Defined\" for the Kubernetes deployment",
                        "line": 35,
                        "match": {
                            "location": "pod_security_policy.go:127"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2002719964
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 35,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 234607
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 35,
                        "match": {
                            "location": "pod_security_policy.go:156"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 570083980
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 35,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 615317107
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostpid;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostPID",
                "description": "",
                "line": 49,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 37
                    },
                    {
                        "name": "@standard/cis/5.2.2",
                        "line": 37
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 49,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 40201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostPID in an existing Kubernetes cluster",
                        "line": 49,
                        "match": {
                            "location": "pod_security_policy.go:188"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 51602
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 49,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 26601
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostPID request is marked \"True\" for the Kubernetes deployment",
                        "line": 49,
                        "match": {
                            "location": "pod_security_policy.go:168"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 180702799
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cannot run using hostPID\"",
                        "line": 49,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 79202
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host PID namespace",
                        "line": 49,
                        "match": {
                            "location": "pod_security_policy.go:198"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 41202
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 49,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 30501
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostpid;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostPID",
                "description": "",
                "line": 50,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 37
                    },
                    {
                        "name": "@standard/cis/5.2.2",
                        "line": 37
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 50,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 28101
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostPID in an existing Kubernetes cluster",
                        "line": 50,
                        "match": {
                            "location": "pod_security_policy.go:188"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 42501
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 50,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 32101
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostPID request is marked \"False\" for the Kubernetes deployment",
                        "line": 50,
                        "match": {
                            "location": "pod_security_policy.go:168"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2040816865
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 50,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 75102
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host PID namespace",
                        "line": 50,
                        "match": {
                            "location": "pod_security_policy.go:198"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 664363754
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 50,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 621399698
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostpid;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostPID",
                "description": "",
                "line": 51,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 37
                    },
                    {
                        "name": "@standard/cis/5.2.2",
                        "line": 37
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 51,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 40702
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostPID in an existing Kubernetes cluster",
                        "line": 51,
                        "match": {
                            "location": "pod_security_policy.go:188"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 48901
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 51,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 51502
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostPID request is marked \"Not Defined\" for the Kubernetes deployment",
                        "line": 51,
                        "match": {
                            "location": "pod_security_policy.go:168"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2125264928
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 51,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 76603
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host PID namespace",
                        "line": 51,
                        "match": {
                            "location": "pod_security_policy.go:198"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 618220797
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 51,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 585495366
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostipc-flag.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostIPC flag.",
                "description": "",
                "line": 65,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 53
                    },
                    {
                        "name": "@standard/cis/5.2.3",
                        "line": 53
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 65,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 44901
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostIPC in an existing Kubernetes cluster",
                        "line": 65,
                        "match": {
                            "location": "pod_security_policy.go:230"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 64202
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 65,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 31201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostIPC request is marked \"True\" for the Kubernetes deployment",
                        "line": 65,
                        "match": {
                            "location": "pod_security_policy.go:209"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 142715201
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with hostIPC access can't run\"",
                        "line": 65,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 82003
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host IPC namespace",
                        "line": 65,
                        "match": {
                            "location": "pod_security_policy.go:240"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 31601
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 65,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 37201
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostipc-flag.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostIPC flag.",
                "description": "",
                "line": 66,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 53
                    },
                    {
                        "name": "@standard/cis/5.2.3",
                        "line": 53
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 66,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 44201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostIPC in an existing Kubernetes cluster",
                        "line": 66,
                        "match": {
                            "location": "pod_security_policy.go:230"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 66902
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 66,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 49102
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostIPC request is marked \"False\" for the Kubernetes deployment",
                        "line": 66,
                        "match": {
                            "location": "pod_security_policy.go:209"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2007311608
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 66,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 79202
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host IPC namespace",
                        "line": 66,
                        "match": {
                            "location": "pod_security_policy.go:240"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 574856931
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 66,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 590604927
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostipc-flag.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostIPC flag.",
                "description": "",
                "line": 67,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 53
                    },
                    {
                        "name": "@standard/cis/5.2.3",
                        "line": 53
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 67,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 48201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostIPC in an existing Kubernetes cluster",
                        "line": 67,
                        "match": {
                            "location": "pod_security_policy.go:230"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 50502
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 67,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 55702
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostIPC request is marked \"Not defined\" for the Kubernetes deployment",
                        "line": 67,
                        "match": {
                            "location": "pod_security_policy.go:209"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1997321893
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 67,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 80902
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host IPC namespace",
                        "line": 67,
                        "match": {
                            "location": "pod_security_policy.go:240"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 651273341
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 67,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 585488165
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostnetwork-flag.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostNetwork flag.",
                "description": "",
                "line": 81,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 69
                    },
                    {
                        "name": "@standard/cis/5.2.4",
                        "line": 69
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 81,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 52602
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostNetwork in an existing Kubernetes cluster",
                        "line": 81,
                        "match": {
                            "location": "pod_security_policy.go:271"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 69902
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 81,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 44201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostNetwork request is marked \"True\" for the Kubernetes deployment",
                        "line": 81,
                        "match": {
                            "location": "pod_security_policy.go:251"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 136537906
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with hostNetwork access can't run\"",
                        "line": 81,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 103604
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host network namespace",
                        "line": 81,
                        "match": {
                            "location": "pod_security_policy.go:281"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 37801
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 81,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 35501
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostnetwork-flag.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostNetwork flag.",
                "description": "",
                "line": 82,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 69
                    },
                    {
                        "name": "@standard/cis/5.2.4",
                        "line": 69
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 82,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 25301
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostNetwork in an existing Kubernetes cluster",
                        "line": 82,
                        "match": {
                            "location": "pod_security_policy.go:271"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 45002
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 82,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 29501
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostNetwork request is marked \"False\" for the Kubernetes deployment",
                        "line": 82,
                        "match": {
                            "location": "pod_security_policy.go:251"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1607611802
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 82,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 240507
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host network namespace",
                        "line": 82,
                        "match": {
                            "location": "pod_security_policy.go:281"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 602242794
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 82,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 601949585
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-hostnetwork-flag.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the hostNetwork flag.",
                "description": "",
                "line": 83,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 69
                    },
                    {
                        "name": "@standard/cis/5.2.4",
                        "line": 69
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 83,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 44402
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the hostNetwork in an existing Kubernetes cluster",
                        "line": 83,
                        "match": {
                            "location": "pod_security_policy.go:271"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 53001
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 83,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 32101
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "hostNetwork request is marked \"Not defined\" for the Kubernetes deployment",
                        "line": 83,
                        "match": {
                            "location": "pod_security_policy.go:251"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1989363042
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 83,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 79603
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that provides access to the host network namespace",
                        "line": 83,
                        "match": {
                            "location": "pod_security_policy.go:281"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 619119126
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 83,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 530126720
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-allowprivilegeescalation-flag;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the allowPrivilegeEscalation flag",
                "description": "",
                "line": 97,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 85
                    },
                    {
                        "name": "@standard/cis/5.2.5",
                        "line": 85
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 97,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 41701
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the allowPrivilegeEscalation in an existing Kubernetes cluster",
                        "line": 97,
                        "match": {
                            "location": "pod_security_policy.go:312"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 49102
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 97,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 32301
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged escalation is marked \"True\" for the Kubernetes deployment",
                        "line": 97,
                        "match": {
                            "location": "pod_security_policy.go:292"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 174314797
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cant run using the allowPrivilegeEscalation flag\"",
                        "line": 97,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod not was created but failure reasons (map[podcreation-error: psp-container-no-privilege:podcreation-error: psp-container-no-privilege]) did not contain expected (podcreation-error: psp-container-no-privilege-escalation)- test failed",
                            "duration": 97804
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 97,
                        "match": {
                            "location": "pod_security_policy.go:156"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 97,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-allowprivilegeescalation-flag;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the allowPrivilegeEscalation flag",
                "description": "",
                "line": 98,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 85
                    },
                    {
                        "name": "@standard/cis/5.2.5",
                        "line": 85
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 98,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 26600
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the allowPrivilegeEscalation in an existing Kubernetes cluster",
                        "line": 98,
                        "match": {
                            "location": "pod_security_policy.go:312"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 45302
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 98,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 37401
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged escalation is marked \"False\" for the Kubernetes deployment",
                        "line": 98,
                        "match": {
                            "location": "pod_security_policy.go:292"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1685536160
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 98,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 94003
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 98,
                        "match": {
                            "location": "pod_security_policy.go:156"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 641913645
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 98,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 563598175
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-with-the-allowprivilegeescalation-flag;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running with the allowPrivilegeEscalation flag",
                "description": "",
                "line": 99,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 85
                    },
                    {
                        "name": "@standard/cis/5.2.5",
                        "line": 85
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 99,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 41501
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running using the allowPrivilegeEscalation in an existing Kubernetes cluster",
                        "line": 99,
                        "match": {
                            "location": "pod_security_policy.go:312"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 56102
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 99,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 32801
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "privileged escalation is marked \"Not Defined\" for the Kubernetes deployment",
                        "line": 99,
                        "match": {
                            "location": "pod_security_policy.go:292"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2154433148
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"No error would show\"",
                        "line": 99,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 85702
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires privileged access",
                        "line": 99,
                        "match": {
                            "location": "pod_security_policy.go:156"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 569046147
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 99,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 666166910
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-as-the-root-user;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running as the root user",
                "description": "",
                "line": 113,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 101
                    },
                    {
                        "name": "@standard/cis/5.2.6",
                        "line": 101
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 113,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 41001
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running as the root user in an existing Kubernetes cluster",
                        "line": 113,
                        "match": {
                            "location": "pod_security_policy.go:344"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 51202
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 113,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 31001
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the user requested is \"Root\" for the Kubernetes deployment",
                        "line": 113,
                        "match": {
                            "location": "pod_security_policy.go:325"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 168494814
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cannot run as root\"",
                        "line": 113,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 82902
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the Kubernetes deployment should run with a non-root UID",
                        "line": 113,
                        "match": {
                            "location": "pod_security_policy.go:354"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 35102
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 113,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 29800
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-as-the-root-user;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running as the root user",
                "description": "",
                "line": 114,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 101
                    },
                    {
                        "name": "@standard/cis/5.2.6",
                        "line": 101
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 114,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 40901
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running as the root user in an existing Kubernetes cluster",
                        "line": 114,
                        "match": {
                            "location": "pod_security_policy.go:344"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 70203
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 114,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 45201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the user requested is \"Non-Root\" for the Kubernetes deployment",
                        "line": 114,
                        "match": {
                            "location": "pod_security_policy.go:325"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1604555906
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 114,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 71702
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the Kubernetes deployment should run with a non-root UID",
                        "line": 114,
                        "match": {
                            "location": "pod_security_policy.go:354"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 575415048
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 114,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 633948694
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-a-deployment-from-running-as-the-root-user;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent a deployment from running as the root user",
                "description": "",
                "line": 115,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 101
                    },
                    {
                        "name": "@standard/cis/5.2.6",
                        "line": 101
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 115,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 108104
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running as the root user in an existing Kubernetes cluster",
                        "line": 115,
                        "match": {
                            "location": "pod_security_policy.go:344"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 80502
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 115,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 54102
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the user requested is \"Not Defined\" for the Kubernetes deployment",
                        "line": 115,
                        "match": {
                            "location": "pod_security_policy.go:325"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2050389766
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 115,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 84903
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "the Kubernetes deployment should run with a non-root UID",
                        "line": 115,
                        "match": {
                            "location": "pod_security_policy.go:354"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 679222222
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 115,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 686790360
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-the-net_raw-capability.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with the NET_RAW capability.",
                "description": "",
                "line": 129,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 117
                    },
                    {
                        "name": "@standard/cis/5.2.7",
                        "line": 117
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 129,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 51502
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running with NET_RAW capability in an existing Kubernetes cluster",
                        "line": 129,
                        "match": {
                            "location": "pod_security_policy.go:383"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] NETRAWIsRestricted is NOT restricted (result: false)",
                            "duration": 78102
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 129,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "NET_RAW is marked \"True\" for the Kubernetes deployment",
                        "line": 129,
                        "match": {
                            "location": "pod_security_policy.go:365"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers cannot run with NET_RAW capabilities\"",
                        "line": 129,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires NET_RAW capability",
                        "line": 129,
                        "match": {
                            "location": "pod_security_policy.go:393"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 129,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-the-net_raw-capability.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with the NET_RAW capability.",
                "description": "",
                "line": 130,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 117
                    },
                    {
                        "name": "@standard/cis/5.2.7",
                        "line": 117
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 130,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 34501
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running with NET_RAW capability in an existing Kubernetes cluster",
                        "line": 130,
                        "match": {
                            "location": "pod_security_policy.go:383"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] NETRAWIsRestricted is NOT restricted (result: false)",
                            "duration": 49402
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 130,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "NET_RAW is marked \"False\" for the Kubernetes deployment",
                        "line": 130,
                        "match": {
                            "location": "pod_security_policy.go:365"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 130,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires NET_RAW capability",
                        "line": 130,
                        "match": {
                            "location": "pod_security_policy.go:393"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 130,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-the-net_raw-capability.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with the NET_RAW capability.",
                "description": "",
                "line": 131,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 117
                    },
                    {
                        "name": "@standard/cis/5.2.7",
                        "line": 117
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 131,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 21600
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent a Kubernetes deployment from running with NET_RAW capability in an existing Kubernetes cluster",
                        "line": 131,
                        "match": {
                            "location": "pod_security_policy.go:383"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] NETRAWIsRestricted is NOT restricted (result: false)",
                            "duration": 41402
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 131,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "NET_RAW is marked \"Not Defined\" for the Kubernetes deployment",
                        "line": 131,
                        "match": {
                            "location": "pod_security_policy.go:365"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 131,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires NET_RAW capability",
                        "line": 131,
                        "match": {
                            "location": "pod_security_policy.go:393"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 131,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-container-running-with-capabilities-beyond-the-default-set.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent container running with capabilities beyond the default set.",
                "description": "",
                "line": 145,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 133
                    },
                    {
                        "name": "@standard/cis/5.2.8",
                        "line": 133
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 145,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 22001
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with capabilities beyond the default set from being deployed to an existing kubernetes cluster",
                        "line": 145,
                        "match": {
                            "location": "pod_security_policy.go:423"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 50102
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 145,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 25900
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "additional capabilities \"ARE\" requested for the Kubernetes deployment",
                        "line": 145,
                        "match": {
                            "location": "pod_security_policy.go:404"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 135890786
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers can't run with added capabilities\"",
                        "line": 145,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 84303
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires capabilities outside of the default set",
                        "line": 145,
                        "match": {
                            "location": "pod_security_policy.go:433"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 37201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 145,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 30901
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-container-running-with-capabilities-beyond-the-default-set.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent container running with capabilities beyond the default set.",
                "description": "",
                "line": 146,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 133
                    },
                    {
                        "name": "@standard/cis/5.2.8",
                        "line": 133
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 146,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 23201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with capabilities beyond the default set from being deployed to an existing kubernetes cluster",
                        "line": 146,
                        "match": {
                            "location": "pod_security_policy.go:423"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 38001
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 146,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 27301
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "additional capabilities \"ARE NOT\" requested for the Kubernetes deployment",
                        "line": 146,
                        "match": {
                            "location": "pod_security_policy.go:404"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2639663951
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 146,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 74503
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires capabilities outside of the default set",
                        "line": 146,
                        "match": {
                            "location": "pod_security_policy.go:433"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 599391204
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 146,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 642693769
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-container-running-with-capabilities-beyond-the-default-set.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent container running with capabilities beyond the default set.",
                "description": "",
                "line": 147,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 133
                    },
                    {
                        "name": "@standard/cis/5.2.8",
                        "line": 133
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 147,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 43701
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with capabilities beyond the default set from being deployed to an existing kubernetes cluster",
                        "line": 147,
                        "match": {
                            "location": "pod_security_policy.go:423"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 54602
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 147,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 32801
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "additional capabilities \"Not Defined\" requested for the Kubernetes deployment",
                        "line": 147,
                        "match": {
                            "location": "pod_security_policy.go:404"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2056382355
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 147,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 77703
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires capabilities outside of the default set",
                        "line": 147,
                        "match": {
                            "location": "pod_security_policy.go:433"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 665462988
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 147,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 582140360
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-assigned-capabilities.;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with assigned capabilities.",
                "description": "",
                "line": 161,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 149
                    },
                    {
                        "name": "@standard/cis/5.2.9",
                        "line": 149
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 161,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 43302
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with assigned capabilities from being deployed to an existing Kubernetes cluster",
                        "line": 161,
                        "match": {
                            "location": "pod_security_policy.go:464"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 55501
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 161,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 30101
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "assigned capabilities \"ARE\" requested for the Kubernetes deployment",
                        "line": 161,
                        "match": {
                            "location": "pod_security_policy.go:444"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 141035248
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Containers with assigned capabilities can't be deployed\"",
                        "line": 161,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 96504
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires any capabilities",
                        "line": 161,
                        "match": {
                            "location": "pod_security_policy.go:474"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 34101
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 161,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 33501
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-assigned-capabilities.;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with assigned capabilities.",
                "description": "",
                "line": 162,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 149
                    },
                    {
                        "name": "@standard/cis/5.2.9",
                        "line": 149
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 162,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 25001
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with assigned capabilities from being deployed to an existing Kubernetes cluster",
                        "line": 162,
                        "match": {
                            "location": "pod_security_policy.go:464"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 50601
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 162,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 50202
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "assigned capabilities \"ARE NOT\" requested for the Kubernetes deployment",
                        "line": 162,
                        "match": {
                            "location": "pod_security_policy.go:444"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2079338379
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 162,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 72503
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires any capabilities",
                        "line": 162,
                        "match": {
                            "location": "pod_security_policy.go:474"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 661078749
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 162,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 602759010
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-with-assigned-capabilities.;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running with assigned capabilities.",
                "description": "",
                "line": 163,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 149
                    },
                    {
                        "name": "@standard/cis/5.2.9",
                        "line": 149
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 163,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 46702
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with assigned capabilities from being deployed to an existing Kubernetes cluster",
                        "line": 163,
                        "match": {
                            "location": "pod_security_policy.go:464"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 60602
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 163,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 39001
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "assigned capabilities \"Not defined\" requested for the Kubernetes deployment",
                        "line": 163,
                        "match": {
                            "location": "pod_security_policy.go:444"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 2112903738
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 163,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 79803
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that requires any capabilities",
                        "line": 163,
                        "match": {
                            "location": "pod_security_policy.go:474"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 591582257
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 163,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 643238787
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-port-range;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved port range",
                "description": "",
                "line": 177,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 165
                    },
                    {
                        "name": "@standard/none/psp-0.1",
                        "line": 165
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 177,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 45902
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved port range from being deployed to an existing Kubernetes cluster",
                        "line": 177,
                        "match": {
                            "location": "pod_security_policy.go:509"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 69202
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 177,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 35801
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"unapproved\" port range is requested for the Kubernetes deployment",
                        "line": 177,
                        "match": {
                            "location": "pod_security_policy.go:485"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 165763628
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Cannot access unapproved port range\"",
                        "line": 177,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 178605
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that access an unapproved port range",
                        "line": 177,
                        "match": {
                            "location": "pod_security_policy.go:519"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 44402
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 177,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 31201
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-port-range;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved port range",
                "description": "",
                "line": 178,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 165
                    },
                    {
                        "name": "@standard/none/psp-0.1",
                        "line": 165
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 178,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 25500
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved port range from being deployed to an existing Kubernetes cluster",
                        "line": 178,
                        "match": {
                            "location": "pod_security_policy.go:509"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 147305
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 178,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 70002
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"approved\" port range is requested for the Kubernetes deployment",
                        "line": 178,
                        "match": {
                            "location": "pod_security_policy.go:485"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 153796551
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 178,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod was not created - test failed: pod creation error: map[podcreation-error: psp-container-allowed-images:podcreation-error: psp-host-network] admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-container-allowed-images-d0318bd54c8157a6fe8c] Container image busybox for container sec-ctx-demo has not been allowed.",
                            "duration": 171405
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that access an unapproved port range",
                        "line": 178,
                        "match": {
                            "location": "pod_security_policy.go:519"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 178,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-port-range;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved port range",
                "description": "",
                "line": 179,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 165
                    },
                    {
                        "name": "@standard/none/psp-0.1",
                        "line": 165
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 179,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 40102
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved port range from being deployed to an existing Kubernetes cluster",
                        "line": 179,
                        "match": {
                            "location": "pod_security_policy.go:509"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 47201
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 179,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 41101
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"not defined\" port range is requested for the Kubernetes deployment",
                        "line": 179,
                        "match": {
                            "location": "pod_security_policy.go:485"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 170611181
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 179,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod was not created - test failed: pod creation error: map[podcreation-error: psp-container-allowed-images:podcreation-error: psp-container-no-privilege] admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-container-allowed-images-d0318bd54c8157a6fe8c] Container image busybox for container sec-ctx-demo has not been allowed.",
                            "duration": 86203
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that access an unapproved port range",
                        "line": 179,
                        "match": {
                            "location": "pod_security_policy.go:519"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 179,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-volume-types;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved volume types",
                "description": "",
                "line": 193,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 181
                    },
                    {
                        "name": "@standard/none/psp-0.2",
                        "line": 181
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 193,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 41401
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved volume types from being deployed to an existing Kubernetes cluster",
                        "line": 193,
                        "match": {
                            "location": "pod_security_policy.go:553"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 49902
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 193,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 41201
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"unapproved\" volume type is requested for the Kubernetes deployment",
                        "line": 193,
                        "match": {
                            "location": "pod_security_policy.go:530"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 189676182
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Cannot access unapproved volume type\"",
                        "line": 193,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 96203
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that accesses an unapproved volume type",
                        "line": 193,
                        "match": {
                            "location": "pod_security_policy.go:564"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 48902
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 193,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 60102
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-volume-types;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved volume types",
                "description": "",
                "line": 194,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 181
                    },
                    {
                        "name": "@standard/none/psp-0.2",
                        "line": 181
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 194,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 50002
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved volume types from being deployed to an existing Kubernetes cluster",
                        "line": 194,
                        "match": {
                            "location": "pod_security_policy.go:553"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 1486647
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 194,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 55702
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"approved\" volume type is requested for the Kubernetes deployment",
                        "line": 194,
                        "match": {
                            "location": "pod_security_policy.go:530"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 151118366
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 194,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod was not created - test failed: pod creation error: map[podcreation-error: psp-container-allowed-images:podcreation-error: psp-host-network] admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-container-allowed-images-d0318bd54c8157a6fe8c] Container image busybox for container sec-ctx-demo has not been allowed.",
                            "duration": 93603
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that accesses an unapproved volume type",
                        "line": 194,
                        "match": {
                            "location": "pod_security_policy.go:564"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 194,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-accessing-unapproved-volume-types;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from accessing unapproved volume types",
                "description": "",
                "line": 195,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 181
                    },
                    {
                        "name": "@standard/none/psp-0.2",
                        "line": 181
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 195,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 25401
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments with unapproved volume types from being deployed to an existing Kubernetes cluster",
                        "line": 195,
                        "match": {
                            "location": "pod_security_policy.go:553"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 46901
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 195,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 36501
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"not defined\" volume type is requested for the Kubernetes deployment",
                        "line": 195,
                        "match": {
                            "location": "pod_security_policy.go:530"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 164027074
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"\"",
                        "line": 195,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod was not created - test failed: pod creation error: map[podcreation-error: psp-container-allowed-images:podcreation-error: psp-allowed-portrange] admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-container-allowed-images-d0318bd54c8157a6fe8c] Container image busybox for container sec-ctx-demo has not been allowed.",
                            "duration": 95103
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a command that accesses an unapproved volume type",
                        "line": 195,
                        "match": {
                            "location": "pod_security_policy.go:564"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 195,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-without-approved-seccomp-profile;;2",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running without approved seccomp profile",
                "description": "",
                "line": 209,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 197
                    },
                    {
                        "name": "@standard/none/psp-0.3",
                        "line": 197
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 209,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 28700
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments without approved seccomp profiles from being deployed to an existing Kubernetes cluster",
                        "line": 209,
                        "match": {
                            "location": "pod_security_policy.go:596"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 79903
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 209,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 35801
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"unapproved\" seccomp profile is requested for the Kubernetes deployment",
                        "line": 209,
                        "match": {
                            "location": "pod_security_policy.go:571"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 86003
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Cannot request unapproved seccomp profile\"",
                        "line": 209,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod  was created - test failed",
                            "duration": 48701
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a system call that is blocked by the seccomp profile",
                        "line": 209,
                        "match": {
                            "location": "pod_security_policy.go:605"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 209,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-without-approved-seccomp-profile;;3",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running without approved seccomp profile",
                "description": "",
                "line": 210,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 197
                    },
                    {
                        "name": "@standard/none/psp-0.3",
                        "line": 197
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 210,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 24601
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments without approved seccomp profiles from being deployed to an existing Kubernetes cluster",
                        "line": 210,
                        "match": {
                            "location": "pod_security_policy.go:596"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 48202
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 210,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 29001
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"approved\" seccomp profile is requested for the Kubernetes deployment",
                        "line": 210,
                        "match": {
                            "location": "pod_security_policy.go:571"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 71502
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Succeed\" with an error \"no error\"",
                        "line": 210,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 50201
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a system call that is blocked by the seccomp profile",
                        "line": 210,
                        "match": {
                            "location": "pod_security_policy.go:605"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] Likely an internal Probr error. Error raised trying to execute verification command (unshare)",
                            "duration": 125098746
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 210,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            },
            {
                "id": "maximise-security-through-pod-security-policies;prevent-deployments-from-running-without-approved-seccomp-profile;;4",
                "keyword": "Scenario Outline",
                "name": "Prevent deployments from running without approved seccomp profile",
                "description": "",
                "line": 211,
                "type": "scenario",
                "tags": [
                    {
                        "name": "@service/kubernetes",
                        "line": 1
                    },
                    {
                        "name": "@control/family/pod_security_policy",
                        "line": 2
                    },
                    {
                        "name": "@csp/azure",
                        "line": 3
                    },
                    {
                        "name": "@csp/aws",
                        "line": 4
                    },
                    {
                        "name": "@csp/gcp",
                        "line": 5
                    },
                    {
                        "name": "@standard/cis/5.2",
                        "line": 7
                    },
                    {
                        "name": "@control/type/preventative",
                        "line": 197
                    },
                    {
                        "name": "@standard/none/psp-0.3",
                        "line": 197
                    }
                ],
                "steps": [
                    {
                        "keyword": "Given ",
                        "name": "a Kubernetes cluster exists which we can deploy into",
                        "line": 211,
                        "match": {
                            "location": "k8s_probes.go:210"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 26901
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "some system exists to prevent Kubernetes deployments without approved seccomp profiles from being deployed to an existing Kubernetes cluster",
                        "line": 211,
                        "match": {
                            "location": "pod_security_policy.go:596"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 85203
                        }
                    },
                    {
                        "keyword": "When ",
                        "name": "a Kubernetes deployment is applied to an existing Kubernetes cluster",
                        "line": 211,
                        "match": {
                            "location": "pod_security_policy.go:31"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 27701
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "an \"undefined\" seccomp profile is requested for the Kubernetes deployment",
                        "line": 211,
                        "match": {
                            "location": "pod_security_policy.go:571"
                        },
                        "result": {
                            "status": "passed",
                            "duration": 70702
                        }
                    },
                    {
                        "keyword": "Then ",
                        "name": "the operation will \"Fail\" with an error \"Approved seccomp profile required\"",
                        "line": 211,
                        "match": {
                            "location": "pod_security_policy.go:37"
                        },
                        "result": {
                            "status": "failed",
                            "error_message": "[ERROR] pod  was created - test failed",
                            "duration": 229807
                        }
                    },
                    {
                        "keyword": "But ",
                        "name": "I should not be able to perform a system call that is blocked by the seccomp profile",
                        "line": 211,
                        "match": {
                            "location": "pod_security_policy.go:605"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    },
                    {
                        "keyword": "And ",
                        "name": "I should be able to perform an allowed command",
                        "line": 211,
                        "match": {
                            "location": "pod_security_policy.go:47"
                        },
                        "result": {
                            "status": "skipped"
                        }
                    }
                ]
            }
        ]
    }
]
